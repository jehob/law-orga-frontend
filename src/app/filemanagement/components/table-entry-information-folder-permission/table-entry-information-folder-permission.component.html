<!--
  ~ law&orga - record and organization management software for refugee law clinics
  ~ Copyright (C) 2020  Dominik Walser
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program.  If not, see <https://www.gnu.org/licenses/>
  -->
<div>
    <h2>Folder permissions:</h2>
    <div *ngIf="folderPermissions | async as catalog; else loading">
        <ng-container *ngIf="catalog.length; else noItems">
            <table mat-table [dataSource]="catalog">
                <ng-container matColumnDef="icon">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let folderPermission">
                        <div [ngSwitch]="folderPermission.permission">
                            <div *ngSwitchCase="'read'">
                                <mat-icon>library_books</mat-icon>
                            </div>
                            <div *ngSwitchCase="'write'">
                                <mat-icon>library_add</mat-icon>
                            </div>
                            <div *ngSwitchCase="'see'">
                                <mat-icon>visibility</mat-icon>
                            </div>
                        </div>
                    </td>
                </ng-container>
                <ng-container matColumnDef="group_name">
                    <th mat-header-cell *matHeaderCellDef>name</th>
                    <td mat-cell *matCellDef="let folderPermission">
                        <div *ngIf="folderPermission.id != -1; else general_permission">
                            {{ folderPermission.group.name }}
                        </div>
                        <ng-template #general_permission>general</ng-template>
                    </td>
                </ng-container>
                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let folderPermission">
                        <div>
                            <div *ngIf="folderPermission.id === '-1'; else down">G</div>
                            <ng-template #down>
                                <div *ngIf="folderPermission.permission === 'see'; else up">
                                    <mat-icon>arrow_down</mat-icon>
                                </div>
                            </ng-template>
                            <ng-template #up>
                                <div *ngIf="folderPermission.folderId !== folderEntry.id; else delete">
                                    <mat-icon>arrow_up</mat-icon>
                                </div>
                            </ng-template>
                            <ng-template #delete>
                                <div><mat-icon>delete</mat-icon></div>
                            </ng-template>
                        </div>
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="columns; sticky: true"></tr>
                <tr mat-row *matRowDef="let row; columns: columns"></tr>
            </table>
        </ng-container>
        <ng-template #noItems>
            <h3>there are no special permissions for this folder</h3>
        </ng-template>
    </div>
    <ng-template #loading>loading animation...</ng-template>
    <button
        mat-icon-button
        class="table-entry-information-folder-permission__button"
        (click)="onAddFolderPermissionClick()"
    >
        <mat-icon>add</mat-icon>
    </button>
</div>
